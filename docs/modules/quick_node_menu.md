# ComfyUI Quick Node Menu (快捷节点菜单)

这是一个为 ComfyUI 设计的**高频节点极速访问工具**。它与 "Add Node Menu" 完美配合，专门用于展示你**收藏 (Favorite)** 的节点和分组，通过精简的列表让你专注于核心工作流。

![alt text](../../images/收藏节点菜单.gif)

## ✨ 核心特性

- **极速唤出**：按下 **`Q`** 键，仅包含你最爱节点的菜单即刻出现。
- **数据联动**：自动读取并同步你在 Add Node Menu (按 `A` 键) 中“收藏”的内容。
- **独立置顶**：拥有独立的置顶 (Pin) 逻辑。你可以在这里将“收藏中的最爱”再次置顶，与主菜单互不干扰。
- **快速管理**：支持直接在菜单中右键移除不再需要的收藏项。
- **视觉区分**：采用紫色系高亮风格，与主菜单的蓝色风格区分，防止混淆。

## 📦 安装方法

本插件通常作为 Add Node Menu 套件的一部分安装。
确保你的 `custom_nodes` 目录下包含本插件的文件夹，并重启 ComfyUI。

## 📖 使用指南

### 1. 如何填充内容？

Quick Menu 默认是空的。你需要先通过 Add Node Menu 添加内容：

1. 按下 **`A`** 键打开主菜单。
2. 在任意节点或分组上 **右键点击**。
3. 选择 **`❤️ 收藏 (Favorite)`**。
4. 现在，按下 **`Q`** 键，该项就会出现在 Quick Menu 中了。

### 2. 基础操作

- **唤出菜单**：在画布空白处，按下键盘上的 **`Q`** 键。
- **添加节点**：点击菜单项即可将节点添加到鼠标当前位置。
- **移除收藏**：
    - 在 Quick Menu 的根目录下，**右键点击**任意项。
    - 选择 **`移除 (Remove)`**。
    - 该项将从收藏列表中删除（同时也会在 Add Node Menu 中取消收藏标记）。

### 3. 独立置顶 (Pinning)

Quick Menu 的置顶是**完全独立**的。你可以在这里通过置顶来调整收藏项的排序，而不会影响 Add Node Menu 的排序。

- **操作方式**：
    - **右键**：点击项，选择 `置顶 (Pin)`。
    - **拖拽**：按住项，将其拖拽到菜单列表的**最上方**。
- **调整顺序**：在置顶区域内，拖拽上下移动即可调整顺序。

### 4. 互斥显示

为了保持界面整洁，当你按下 `Q` 键时，如果屏幕上已打开了 `A` 键菜单，它会自动关闭，反之亦然。屏幕上永远只会存在一个菜单。

## 💾 数据存储

Quick Menu 与 Add Node Menu 共享收藏数据，但拥有独立的配置文件：

- **数据路径**：`ComfyUI/user/AlignLayout/`
- **文件说明**：
    - `add_node_menu_quick.json` (🔴 **核心共享文件**)：存储所有被“收藏”的节点和分组数据。Quick Menu 读取此文件显示内容。
    - `quick_menu_pins.json` (🔵 **独立文件**)：仅记录 Quick Menu 内部的置顶排序。
    - `quick_menu_last_category.json` (🔵 **独立文件**)：记录 Quick Menu 上次打开的位置。

## 常见问题 (Q&A)

**Q: 按下 Q 键提示 "Quick Menu is empty"？**
A: 请先按 `A` 打开主菜单，右键点击你常用的节点选择“收藏”，然后再按 `Q`。

**Q: 我在 Quick Menu 里置顶了节点，按 A 键的主菜单里也会置顶吗？**
A: **不会**。两者的置顶系统是分开的。这允许你在主菜单保留一套通用的置顶逻辑，而在 Quick Menu 建立一套针对特定任务的置顶逻辑。

**Q: 如果我删除了 Add Node Menu 插件，这个还能用吗？**
A: Quick Menu 依赖 `add_node_menu_quick.json` 数据文件。虽然理论上代码分离了，但设计逻辑上它们是伴生关系，建议同时保留。